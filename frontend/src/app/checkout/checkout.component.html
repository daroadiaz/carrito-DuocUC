<div class="container">
  <div class="row">
    <div class="eight columns offset-by-two">
      <div class="checkout-container">
        <h2 class="text-center">Finalizar Compra</h2>

        <!-- Indicador de carga -->
        <div *ngIf="cargando" class="text-center">
          <p>Cargando, por favor espera...</p>
        </div>

        <!-- Confirmación de la compra -->
        <div *ngIf="articulosCarrito.length > 0; else carritoVacio">
          <div id="resumen-compra" class="margin-bottom">
            <h4>Resumen del Pedido</h4>
            <div *ngFor="let item of articulosCarrito" class="resumen-item">
              <div class="item-info" style="display: flex; align-items:center; gap:10px;">
                <img [src]="item.imagen" width="50" alt="{{ item.titulo }}">
                <span class="item-titulo">{{ item.titulo }}</span>
              </div>
              <div class="item-precio" style="text-align:right;">
                <span>{{ item.precio }} x {{ item.cantidad }}</span>
                <strong>${{ calcularPrecioItem(item) }}</strong>
              </div>
            </div>
            <h3 class="text-right mt-4">Total: ${{ total }}</h3>
          </div>
        </div>
        
        <ng-template #carritoVacio>
          <p class="text-center">El carrito está vacío. Agrega productos antes de confirmar tu compra.</p>
        </ng-template>
        

        <!-- Formulario de compra -->
        <form *ngIf="!compraConfirmada" id="checkout-form" novalidate (ngSubmit)="onSubmit($event)">
          <div class="row">
            <div class="twelve columns">
              <label for="nombre">Nombre Completo</label>
              <input
                class="u-full-width"
                type="text"
                id="nombre"
                required
                [(ngModel)]="nombre"
                name="nombre"
              />
              <span id="nombreError" class="error-message">{{ nombreError }}</span>
            </div>
          </div>
          <div class="row">
            <div class="twelve columns">
              <label for="email">Correo Electrónico</label>
              <input
                class="u-full-width"
                type="email"
                id="email"
                required
                [(ngModel)]="email"
                name="email"
              />
              <span id="emailError" class="error-message">{{ emailError }}</span>
            </div>
          </div>
          <div class="row">
            <div class="twelve columns">
              <label for="direccion">Dirección de Envío</label>
              <textarea
                class="u-full-width"
                id="direccion"
                required
                [(ngModel)]="direccion"
                name="direccion"
              ></textarea>
              <span id="direccionError" class="error-message">{{ direccionError }}</span>
            </div>
          </div>
          <button type="submit" class="button-primary u-full-width">
            Confirmar Compra
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
